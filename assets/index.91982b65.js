var z=Object.defineProperty,D=Object.defineProperties;var P=Object.getOwnPropertyDescriptors;var _=Object.getOwnPropertySymbols;var T=Object.prototype.hasOwnProperty,N=Object.prototype.propertyIsEnumerable;var M=(o,e,t)=>e in o?z(o,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[e]=t,A=(o,e)=>{for(var t in e||(e={}))T.call(e,t)&&M(o,t,e[t]);if(_)for(var t of _(e))N.call(e,t)&&M(o,t,e[t]);return o},R=(o,e)=>D(o,P(e));var k=(o,e)=>{var t={};for(var n in o)T.call(o,n)&&e.indexOf(n)<0&&(t[n]=o[n]);if(o!=null&&_)for(var n of _(o))e.indexOf(n)<0&&N.call(o,n)&&(t[n]=o[n]);return t};import{c as F,a as c,i as V,j as C,b as B,u as w,r as m,d as j,e as W,p as G,T as J,y as K,B as H,H as Z,f as d,g,h,k as E,l as $,s as q,C as Y,V as Q,O as X,R as ee}from"./vendor.3882122c.js";const te=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function t(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerpolicy&&(a.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?a.credentials="include":s.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(s){if(s.ep)return;s.ep=!0;const a=t(s);fetch(s.href,a)}};te();const O={harvester:{cost:5},soldier:{cost:10}},oe=F({id:"game",initial:"idle",context:{elapsed:0,tickInterval:1,energy:0,harvester:0,soldier:0,viewedModule:null,allocations:{harvester:{cpu:0,gpu:0,ram:0,ssd:0,psu:0},soldier:{cpu:0,gpu:0,ram:0,ssd:0,psu:0}}},states:{idle:{on:{START:{target:"running",actions:"setResources"},RESUME:{target:"running",actions:"setContext"}}},running:{invoke:{src:"spawnTick"},on:{PAUSE:"paused",END_GAME:"ended",TICK:{actions:"processGame"},VIEW_MODULE:{actions:"setViewedModule"},BUILD_UNIT:{actions:"buildUnit",cond:"hasEnergyForUnit"},ALLOCATE_UNIT:{actions:"allocateUnit",cond:"hasUnit"},RECALL_UNIT:{actions:"recallUnit",cond:"hasAllocatedUnits"},KILL_UNIT:{actions:"killUnit",cond:"hasAllocatedUnits"}}},paused:{on:{START:"running"}},ended:{on:{RESET:{target:"idle",actions:"resetContext"}}}}},{guards:{hasUnit:(o,e)=>e.type==="ALLOCATE_UNIT"&&o[e.unit]>0,hasEnergyForUnit:(o,e)=>e.type==="BUILD_UNIT"&&o.energy>=O[e.unit].cost,hasAllocatedUnits:(o,e)=>(e.type==="KILL_UNIT"||e.type==="RECALL_UNIT")&&o.allocations[e.unit][e.part]>=1},services:{spawnTick:({tickInterval:o})=>e=>{const t=setInterval(()=>e("TICK"),1e3*o);return()=>clearInterval(t)}},actions:{setResources:c((o,e)=>e.type!=="START"?{}:e.resources),buildUnit:c((o,e)=>{if(e.type!=="BUILD_UNIT")return{};const{unit:t}=e;return{energy:o.energy-O[t].cost,[t]:o[t]+1}}),allocateUnit:c((o,e)=>{if(e.type!=="ALLOCATE_UNIT")return{};const{unit:t,part:n}=e,s=JSON.parse(JSON.stringify(o.allocations));return s[t][n]+=1,{[t]:o[t]-1,allocations:s}}),recallUnit:c((o,e)=>{if(e.type!=="RECALL_UNIT")return{};const{unit:t,part:n}=e,s=JSON.parse(JSON.stringify(o.allocations));return s[t][n]-=1,{[t]:o[t]+1,allocations:s}}),killUnit:c((o,e)=>{if(e.type!=="KILL_UNIT")return{};const t=JSON.parse(JSON.stringify(o.allocations));return t[e.unit][e.part]-=1,{allocations:t}}),processGame:c((o,e)=>({elapsed:o.elapsed+o.tickInterval})),setViewedModule:c((o,e)=>e.type!=="VIEW_MODULE"?{}:{viewedModule:e.module}),resetContext:c((o,e)=>e.type!=="END_GAME"?{}:{energy:0,harvester:0,soldier:0,viewedModule:null,allocations:{harvester:{cpu:0,gpu:0,ram:0,ssd:0,psu:0},soldier:{cpu:0,gpu:0,ram:0,ssd:0,psu:0}}}),setContext:c((o,e)=>e.type!=="RESUME"?{}:e.context)}}),I=V(oe),r=C.exports.jsx,i=C.exports.jsxs,re=C.exports.Fragment,x=({label:o,onClick:e,className:t,disabled:n=!1})=>r("button",{onClick:e,type:"button",className:B("px-2 py-1 border rounded disabled:opacity-50 disabled:cursor-auto",t),disabled:n,children:o}),ne=()=>{const[o,e]=w(I);m.exports.useEffect(()=>{e({type:"START",resources:{energy:100,harvester:5,soldier:5}})},[]);const{energy:t,harvester:n,soldier:s}=o.context;return i("div",{className:"absolute inset-0 pointer-events-none h-full w-full z-10 flex flex-col justify-between items-end select-none",children:[o.matches("ended")&&r("p",{children:"Ended"}),i("div",{className:"p-2",children:[i("p",{children:["Elapsed: ",o.context.elapsed]}),r("h4",{children:"Resources"}),i("p",{children:["Energy: ",t]}),i("p",{children:["Harvesters: ",n]}),i("p",{children:["Soldiers: ",s]})]}),i("div",{className:"p-2 pointer-events-auto",children:[r(x,{onClick:()=>e("PAUSE"),label:"pause"}),r(x,{disabled:t===0,onClick:()=>e({type:"BUILD_UNIT",unit:"harvester"}),label:"Build harvester (-5)"}),r(x,{disabled:t===0,onClick:()=>e({type:"BUILD_UNIT",unit:"soldier"}),label:"Build soldier (-10)"})]}),o.matches("paused")&&i("div",{className:"absolute w-full h-full bg-black bg-opacity-20 backdrop-filter backdrop-blur-sm grid place-content-center pointer-events-auto text-white",children:[r("h2",{className:"uppercase text-8xl",children:"Paused"}),r(x,{onClick:()=>e("START"),label:"resume"})]})]})},se=()=>i(j,{children:[r(W,{intensity:.6,height:300,luminanceThreshold:.4,luminanceSmoothing:.9}),r(G,{opacity:.1}),r(J,{eskil:!1,offset:.1,darkness:1.1}),r(K,{blendFunction:H.MULTIPLY,samples:30,rings:4,distanceThreshold:1,distanceFalloff:0,rangeThreshold:.5,rangeFalloff:.1,luminanceInfluence:.9,radius:20,scale:.5,bias:.5})]}),b=.1,y={mass:1,tension:1e3,friction:25,precision:1e-4},p=new URL("/game-off-2021/assets/computer.185dcdf2.glb",self.location).href,f=()=>(m.exports.useEffect(()=>{I.start()},[]),w(I)),U=({onClick:o,label:e,className:t})=>r("button",{type:"button",className:`border border-white px-2 py-1 ${t}`,onClick:o,children:e}),v=({name:o})=>{const[e,t]=f(),{harvester:n,soldier:s}=e.context.allocations;return i(Z,{as:"div",distanceFactor:.5,zIndexRange:[1e3,0],sprite:!0,className:"text-white bg-gray-800 text-xs p-2 select-none min-w-[10rem] rounded-md",children:[r("p",{children:o}),i("p",{children:["Harvesters: ",n[o],r(U,{label:"+",onClick:()=>t({type:"ALLOCATE_UNIT",unit:"harvester",part:o})}),r(U,{label:"-",onClick:()=>t({type:"RECALL_UNIT",unit:"harvester",part:o})})]}),i("p",{children:["Soldiers: ",s[o],r(U,{label:"+",onClick:()=>t({type:"ALLOCATE_UNIT",unit:"soldier",part:o})}),r(U,{label:"-",onClick:()=>t({type:"RECALL_UNIT",unit:"soldier",part:o})})]}),r(U,{label:"Done",onClick:()=>t({type:"VIEW_MODULE",module:null})})]})},ae=()=>{const[o,e]=f(),t=o.context.viewedModule==="psu",{nodes:n}=d(p),[{z:s}]=g({z:t?b+.04:.04,config:y},[t]);return r(h.mesh,{name:"psu",onClick:a=>{a.stopPropagation(),e({type:"VIEW_MODULE",module:t?null:"psu"})},geometry:n.psu.geometry,material:n.psu.material,"position-x":.002,"position-y":.159,"position-z":s,children:t&&r(v,{name:"psu"})})},ie=()=>{const o=.061,[e,t]=f(),n=e.context.viewedModule==="gpu",{nodes:s,materials:a}=d(p),[{z:l}]=g({z:n?b+o:o,config:y},[n]),u=m.exports.useRef(null);return E(()=>{u.current.rotation.y+=.1}),i(h.group,{name:"gpu",onClick:L=>{L.stopPropagation(),t({type:"VIEW_MODULE",module:n?null:"gpu"})},"position-x":.003,"position-y":-.076,"position-z":l,children:[r("mesh",{geometry:s.Cube002.geometry,material:s.Cube002.material}),r("mesh",{geometry:s.Cube002_1.geometry,material:s.Cube002_1.material}),r("mesh",{geometry:s.Cube002_2.geometry,material:s.Cube002_2.material}),r("mesh",{name:"gpu-fan",ref:u,geometry:s.gpu_fan.geometry,material:a.light_metal,position:[.07,.015,.001]}),n&&r(v,{name:"gpu"})]})},le=()=>{const[o,e]=f(),t=o.context.viewedModule==="cpu",{nodes:n,materials:s}=d(p),[{z:a}]=g({z:t?b+.037:.037,config:y},[t]),[{z:l}]=g({z:t?.06:.012,config:y},[t]),u=m.exports.useRef(null);return E(()=>{u.current.rotation.z+=.1}),i(re,{children:[r(h.mesh,{name:"cpu",geometry:n.cpu.geometry,material:n.cpu.material,"position-x":0,"position-y":0,"position-z":l}),i(h.group,{name:"cpu-cooler",onClick:L=>{L.stopPropagation(),e({type:"VIEW_MODULE",module:t?null:"cpu"})},"position-x":0,"position-y":0,"position-z":a,children:[r("mesh",{geometry:n.Cube011.geometry,material:n.Cube011.material}),r("mesh",{geometry:n.Cube011_1.geometry,material:s.sand}),r("mesh",{name:"cpu-fan",ref:u,geometry:n.cpu_fan.geometry,material:s.brown,position:[0,0,.01]}),t&&r(v,{name:"cpu"})]})]})};var S="varying vec2 vUv;void main(){vUv=uv;gl_Position=projectionMatrix*modelViewMatrix*vec4(position,1.0);}",ce="uniform float time;varying vec2 vUv;void main(){vec3 rgb=0.5+0.5*cos(time+vUv.xyx+vec3(0,2,4));gl_FragColor=vec4(rgb,1.0);}";console.log(S);const ue=q({time:0},S,ce);$({RamMaterial:ue});const de=()=>{const[o,e]=f(),t=o.context.viewedModule==="ram",{nodes:n,materials:s}=d(p),[{z:a}]=g({z:t?b+.047:.047,config:y},[t]),l=m.exports.useRef(null);return E(()=>l.current.uniforms.time.value+=.01),i(h.group,{onClick:u=>{u.stopPropagation(),e({type:"VIEW_MODULE",module:t?null:"ram"})},"position-x":.068,"position-y":.013,"position-z":a,children:[r("mesh",{geometry:n.Cube009.geometry,material:n.Cube009.material}),r("mesh",{geometry:n.Cube009_1.geometry,material:n.Cube009_1.material}),r("mesh",{geometry:n.Cube009_2.geometry,material:s.red,children:r("ramMaterial",{ref:l,attach:"material",color:"hotpink"})}),t&&r(v,{name:"ram"})]})},pe=()=>{const[o,e]=f(),t=o.context.viewedModule==="ssd",{nodes:n}=d(p),[{z:s}]=g({z:t?b+.016:.016,config:y},[t]);return r(h.mesh,{onClick:a=>{a.stopPropagation(),e({type:"VIEW_MODULE",module:t?null:"ssd"})},geometry:n.ssd.geometry,material:n.ssd.material,"position-x":0,"position-y":.062,"position-z":s,children:t&&r(v,{name:"ssd"})})};d.preload(p);const me=e=>{var o=k(e,[]);const{nodes:t,materials:n}=d(p);return i("group",R(A({},o),{dispose:null,children:[r("mesh",{name:"motherboard",geometry:t.motherboard.geometry,material:n.green}),r("mesh",{name:"io",geometry:t.io.geometry,material:t.io.material,position:[-.092,.014,.032]}),r("mesh",{name:"motherboard_gpu_io",geometry:t.motherboard_gpu_io.geometry,material:t.motherboard_gpu_io.material,position:[-.044,-.077,.009]}),r("mesh",{name:"motherboard_cpu_io",geometry:t.motherboard_cpu_io.geometry,material:n.white,position:[0,0,.005]}),r("mesh",{name:"ram_io",geometry:t.ram_io.geometry,material:t.ram_io.material,position:[.078,.013,.008]}),r(ae,{}),r(ie,{}),r(de,{}),r(le,{}),r(pe,{})]}))},ge=()=>i("div",{className:"h-screen w-screen",children:[i(Y,{mode:"concurrent",dpr:Math.min(1.5,window.devicePixelRatio),gl:{antialias:!0},camera:{position:new Q(-.25,.25,.25)},children:[r("ambientLight",{intensity:.5}),r("pointLight",{position:[10,10,10]}),r(X,{enablePan:!1,enableZoom:!1,enableRotate:!0}),r(me,{}),r(se,{})]}),r(ne,{})]});ee.render(r(m.exports.StrictMode,{children:r(ge,{})}),document.getElementById("root"));
