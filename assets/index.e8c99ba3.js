var _=Object.defineProperty,A=Object.defineProperties;var O=Object.getOwnPropertyDescriptors;var g=Object.getOwnPropertySymbols;var L=Object.prototype.hasOwnProperty,M=Object.prototype.propertyIsEnumerable;var T=(s,e,t)=>e in s?_(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,I=(s,e)=>{for(var t in e||(e={}))L.call(e,t)&&T(s,t,e[t]);if(g)for(var t of g(e))M.call(e,t)&&T(s,t,e[t]);return s},C=(s,e)=>A(s,O(e));var N=(s,e)=>{var t={};for(var n in s)L.call(s,n)&&e.indexOf(n)<0&&(t[n]=s[n]);if(s!=null&&g)for(var n of g(s))e.indexOf(n)<0&&M.call(s,n)&&(t[n]=s[n]);return t};import{c as k,a as d,i as D,j as w,b as z,u as R,r as S,H as P,d as u,e as h,f,C as V,V as j,O as B,g as W,h as G,p as H,T as F,R as K,k as Z}from"./vendor.df1185dd.js";const q=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function t(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerpolicy&&(i.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?i.credentials="include":r.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(r){if(r.ep)return;r.ep=!0;const i=t(r);fetch(r.href,i)}};q();const $={harvester:{cost:5},soldier:{cost:10}},J=k({id:"game",initial:"idle",context:{energy:0,harvester:0,soldier:0,viewedModule:null,allocations:{harvester:{cpu:0,gpu:0,ram:0,ssd:0,psu:0},soldier:{cpu:0,gpu:0,ram:0,ssd:0,psu:0}}},states:{idle:{on:{START:{target:"running",actions:"setResources"},RESUME:{target:"running",actions:"setContext"}}},running:{on:{PAUSE:"paused",END_GAME:"ended",VIEW_MODULE:{target:"running",actions:"setViewedModule"},BUILD_UNIT:{target:"running",actions:"buildUnit"},ALLOCATE_UNITS:{target:"running",actions:"setAllocatedUnits"},KILL_UNITS:{target:"running",actions:"setAllocatedUnits"}}},paused:{on:{START:"running"}},ended:{on:{RESET:{target:"idle",actions:"resetContext"}}}}},{actions:{setResources:d((s,e)=>e.type!=="START"?{}:e.resources),setAllocatedUnits:d((s,e)=>{if(e.type==="ALLOCATE_UNITS"){const{allocation:t}=e;return s.allocations[t.type][t.module]+=t.amount,s.allocations}if(e.type==="KILL_UNITS"){const{allocation:t}=e;s.allocations[t.type][t.module]-=t.amount}return{}}),setViewedModule:d((s,e)=>e.type!=="VIEW_MODULE"?{}:{viewedModule:e.module}),resetContext:d((s,e)=>e.type!=="END_GAME"?{}:{energy:0,harvester:0,soldier:0,viewedModule:null,allocations:{harvester:{cpu:0,gpu:0,ram:0,ssd:0,psu:0},soldier:{cpu:0,gpu:0,ram:0,ssd:0,psu:0}}}),setContext:d((s,e)=>e.type!=="RESUME"?{}:e.context),buildUnit:d((s,e)=>{if(e.type!=="BUILD_UNIT")return{};const{unit:t}=e;return{energy:s.energy-$[t].cost,[t]:s[t]+1}})}}),U=D(J),o=w.exports.jsx,a=w.exports.jsxs,y=({label:s,onClick:e,className:t,disabled:n=!1})=>o("button",{onClick:e,type:"button",className:z("px-2 py-1 border rounded disabled:opacity-50 disabled:cursor-auto",t),disabled:n,children:s}),Q=()=>{const[s,e]=R(U);S.exports.useEffect(()=>{e({type:"START",resources:{energy:100,harvester:5,soldier:5}})},[]);const{energy:t,harvester:n,soldier:r}=s.context;return a("div",{className:"absolute inset-0 pointer-events-none h-full w-full z-10 flex flex-col justify-between items-end select-none",children:[s.matches("ended")&&o("p",{children:"Ended"}),a("div",{className:"p-2",children:[o("h4",{children:"Resources"}),a("p",{children:["Energy: ",t]}),a("p",{children:["Harvesters: ",n]}),a("p",{children:["Soldiers: ",r]})]}),a("div",{className:"p-2 pointer-events-auto",children:[o(y,{onClick:()=>e("PAUSE"),label:"pause"}),o(y,{disabled:t===0,onClick:()=>e({type:"BUILD_UNIT",unit:"harvester"}),label:"Build harvester (-5)"}),o(y,{disabled:t===0,onClick:()=>e({type:"BUILD_UNIT",unit:"soldier"}),label:"Build soldier (-10)"})]}),s.matches("paused")&&a("div",{className:"absolute w-full h-full bg-black bg-opacity-20 backdrop-filter backdrop-blur-sm grid place-content-center pointer-events-auto text-white",children:[o("h2",{className:"uppercase text-8xl",children:"Paused"}),o(y,{onClick:()=>e("START"),label:"resume"})]})]})},b=.1,v={mass:1,tension:1e3,friction:25,precision:1e-4},p=new URL("/game-off-2021/assets/computer.5b102dfe.glb",self.location).href,x=()=>(S.exports.useEffect(()=>{U.start()},[]),R(U)),E=({name:s,harvesters:e,soldiers:t,onClose:n})=>a(P,{as:"div",distanceFactor:.25,zIndexRange:[100,0],transform:!0,sprite:!0,className:"text-white bg-gray-800 text-xs p-2 select-none",children:[o("p",{children:s}),a("p",{children:["Harvesters: ",e]}),a("p",{children:["Solidiers: ",t]}),o("button",{type:"button",className:"border rounded border-white px-2 py-1",onClick:n,children:"Done"})]}),X=()=>{const[s,e]=x(),{viewedModule:t,allocations:n}=s.context,r=t==="gpu",{nodes:i}=u(p),[{z:l}]=h({z:r?b+.06:.06,config:v},[t]),c=()=>e({type:"VIEW_MODULE",module:r?null:"gpu"});return o(f.mesh,{onClick:c,geometry:i.gpu.geometry,material:i.gpu.material,"position-x":0,"position-y":-.08,"position-z":l,children:r&&o(E,{name:"gpu",harvesters:n.harvester.gpu,soldiers:n.soldier.gpu,onClose:c})})},Y=()=>{const[s,e]=x(),{viewedModule:t,allocations:n}=s.context,r=t==="cpu",{nodes:i,materials:l}=u(p),[{z:c}]=h({z:r?b+.02:.02,config:v},[t]),m=()=>e({type:"VIEW_MODULE",module:r?null:"cpu"});return o(f.mesh,{onClick:m,geometry:i.cpu.geometry,material:l.sand,"position-x":0,"position-y":0,"position-z":c,children:r&&o(E,{name:"cpu",harvesters:n.harvester.cpu,soldiers:n.soldier.cpu,onClose:m})})},ee=()=>{const[s,e]=x(),{viewedModule:t,allocations:n}=s.context,r=t==="ram",{nodes:i,materials:l}=u(p),[{z:c}]=h({z:t==="ram"?b+.04:.04,config:v},[t]),m=()=>e({type:"VIEW_MODULE",module:r?null:"ram"});return o(f.mesh,{onClick:m,geometry:i.ram.geometry,material:l.red,"position-x":.07,"position-y":.01,"position-z":c,children:r&&o(E,{name:"ram",harvesters:n.harvester.ram,soldiers:n.soldier.ram,onClose:m})})},te=()=>{const[s,e]=x(),{viewedModule:t,allocations:n}=s.context,r=t==="ssd",{nodes:i}=u(p),[{z:l}]=h({z:t==="ssd"?b+.02:.02,config:v},[t]),c=()=>e({type:"VIEW_MODULE",module:r?null:"ssd"});return o(f.mesh,{onClick:c,geometry:i.ssd.geometry,material:i.ssd.material,"position-x":0,"position-y":.06,"position-z":l,children:r&&o(E,{name:"ssd",harvesters:n.harvester.ssd,soldiers:n.soldier.ssd,onClose:c})})};u.preload(p);const se=e=>{var s=N(e,[]);const{nodes:t,materials:n}=u(p);return a("group",C(I({},s),{dispose:null,children:[o("mesh",{geometry:t.motherboard.geometry,material:n.green}),o(X,{}),o("mesh",{geometry:t.io.geometry,material:t.io.material,position:[-.09,.01,.03]}),o("mesh",{geometry:t["motherboard-gpu-io"].geometry,material:t["motherboard-gpu-io"].material,position:[-.04,-.08,-.01]}),o("mesh",{geometry:t["motherboard-cpu-io"].geometry,material:n.white}),o(ee,{}),o(Y,{}),o(te,{})]}))},oe=()=>a("div",{className:"h-screen w-screen",children:[a(V,{mode:"concurrent",dpr:Math.min(1.5,window.devicePixelRatio),gl:{antialias:!1},camera:{position:new j(0,0,.5)},children:[o("ambientLight",{}),o("pointLight",{position:[10,10,10]}),o(B,{enablePan:!1,enableZoom:!1,enableRotate:!0}),o(se,{}),a(W,{children:[o(G,{luminanceThreshold:0,luminanceSmoothing:.9,height:300}),o(H,{opacity:.1}),o(F,{eskil:!1,offset:.1,darkness:1.1})]})]}),o(Q,{})]});K.render(o(Z.StrictMode,{children:o(oe,{})}),document.getElementById("root"));
