var A=Object.defineProperty,_=Object.defineProperties;var R=Object.getOwnPropertyDescriptors;var m=Object.getOwnPropertySymbols;var U=Object.prototype.hasOwnProperty,M=Object.prototype.propertyIsEnumerable;var I=(s,e,t)=>e in s?A(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,L=(s,e)=>{for(var t in e||(e={}))U.call(e,t)&&I(s,t,e[t]);if(m)for(var t of m(e))M.call(e,t)&&I(s,t,e[t]);return s},T=(s,e)=>_(s,R(e));var C=(s,e)=>{var t={};for(var r in s)U.call(s,r)&&e.indexOf(r)<0&&(t[r]=s[r]);if(s!=null&&m)for(var r of m(s))e.indexOf(r)<0&&M.call(s,r)&&(t[r]=s[r]);return t};import{c as k,a as d,i as D,j as N,b as O,u as S,r as w,H as z,d as u,e as g,f as h,C as V,V as P,O as j,g as B,h as W,p as G,T as H,R as F,k as K}from"./vendor.df1185dd.js";const Z=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function t(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerpolicy&&(i.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?i.credentials="include":n.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(n){if(n.ep)return;n.ep=!0;const i=t(n);fetch(n.href,i)}};Z();const q={harvester:{cost:5},soldier:{cost:10}},$=k({id:"game",initial:"idle",context:{energy:0,harvester:0,soldier:0,viewedModule:null,allocations:{harvester:{cpu:0,gpu:0,ram:0,ssd:0,psu:0},soldier:{cpu:0,gpu:0,ram:0,ssd:0,psu:0}}},states:{idle:{on:{START:{target:"running",actions:"setResources"},RESUME:{target:"running",actions:"setContext"}}},running:{on:{PAUSE:"paused",END_GAME:"ended",VIEW_MODULE:{target:"running",actions:"setViewedModule"},BUILD_UNIT:{target:"running",actions:"buildUnit"},ALLOCATE_UNITS:{target:"running",actions:"setAllocatedUnits"},KILL_UNITS:{target:"running",actions:"setAllocatedUnits"}}},paused:{on:{START:"running"}},ended:{on:{RESET:{target:"idle",actions:"resetContext"}}}}},{actions:{setResources:d((s,e)=>e.type!=="START"?{}:e.resources),setAllocatedUnits:d((s,e)=>{if(e.type==="ALLOCATE_UNITS"){const{allocation:t}=e;return s.allocations[t.type][t.module]+=t.amount,s.allocations}if(e.type==="KILL_UNITS"){const{allocation:t}=e;s.allocations[t.type][t.module]-=t.amount}return{}}),setViewedModule:d((s,e)=>e.type!=="VIEW_MODULE"?{}:{viewedModule:e.module}),resetContext:d((s,e)=>e.type!=="END_GAME"?{}:{energy:0,harvester:0,soldier:0,viewedModule:null,allocations:{harvester:{cpu:0,gpu:0,ram:0,ssd:0,psu:0},soldier:{cpu:0,gpu:0,ram:0,ssd:0,psu:0}}}),setContext:d((s,e)=>e.type!=="RESUME"?{}:e.context),buildUnit:d((s,e)=>{if(e.type!=="BUILD_UNIT")return{};const{unit:t}=e;return{energy:s.energy-q[t].cost,[t]:s[t]+1}})}}),E=D($),o=N.exports.jsx,a=N.exports.jsxs,y=({label:s,onClick:e,className:t,disabled:r=!1})=>o("button",{onClick:e,type:"button",className:O("px-2 py-1 border rounded disabled:opacity-50 disabled:cursor-auto",t),disabled:r,children:s}),J=()=>{const[s,e]=S(E);w.exports.useEffect(()=>{e({type:"START",resources:{energy:100,harvester:5,soldier:5}})},[]);const{energy:t,harvester:r,soldier:n}=s.context;return a("div",{className:"absolute inset-0 pointer-events-none h-full w-full z-10 flex flex-col justify-between items-end select-none",children:[s.matches("ended")&&o("p",{children:"Ended"}),a("div",{className:"p-2",children:[o("h4",{children:"Resources"}),a("p",{children:["Energy: ",t]}),a("p",{children:["Harvesters: ",r]}),a("p",{children:["Soldiers: ",n]})]}),a("div",{className:"p-2 pointer-events-auto",children:[o(y,{onClick:()=>e("PAUSE"),label:"pause"}),o(y,{disabled:t===0,onClick:()=>e({type:"BUILD_UNIT",unit:"harvester"}),label:"Build harvester (-5)"}),o(y,{disabled:t===0,onClick:()=>e({type:"BUILD_UNIT",unit:"soldier"}),label:"Build soldier (-10)"})]}),s.matches("paused")&&a("div",{className:"absolute w-full h-full bg-black bg-opacity-20 backdrop-filter backdrop-blur-sm grid place-content-center pointer-events-auto text-white",children:[o("h2",{className:"uppercase text-8xl",children:"Paused"}),o(y,{onClick:()=>e("START"),label:"resume"})]})]})},f=()=>(w.exports.useEffect(()=>{E.start()},[]),S(E)),b=.1,v={mass:1,tension:1e3,friction:25,precision:1e-4},x=({name:s,harvesters:e,soldiers:t,onClose:r})=>a(z,{as:"div",distanceFactor:.25,zIndexRange:[100,0],transform:!0,sprite:!0,className:"text-white bg-gray-800 text-xs p-2 select-none",children:[o("p",{children:s}),a("p",{children:["Harvesters: ",e]}),a("p",{children:["Solidiers: ",t]}),o("button",{type:"button",className:"border rounded border-white px-2 py-1",onClick:r,children:"Done"})]}),Q=()=>{const[s,e]=f(),{viewedModule:t,allocations:r}=s.context,n=t==="gpu",{nodes:i}=u("./static/computer.glb"),[{z:l}]=g({z:n?b+.06:.06,config:v},[t]),c=()=>e({type:"VIEW_MODULE",module:n?null:"gpu"});return o(h.mesh,{onClick:c,geometry:i.gpu.geometry,material:i.gpu.material,"position-x":0,"position-y":-.08,"position-z":l,children:n&&o(x,{name:"gpu",harvesters:r.harvester.gpu,soldiers:r.soldier.gpu,onClose:c})})},X=()=>{const[s,e]=f(),{viewedModule:t,allocations:r}=s.context,n=t==="cpu",{nodes:i,materials:l}=u("./static/computer.glb"),[{z:c}]=g({z:n?b+.02:.02,config:v},[t]),p=()=>e({type:"VIEW_MODULE",module:n?null:"cpu"});return o(h.mesh,{onClick:p,geometry:i.cpu.geometry,material:l.sand,"position-x":0,"position-y":0,"position-z":c,children:n&&o(x,{name:"cpu",harvesters:r.harvester.cpu,soldiers:r.soldier.cpu,onClose:p})})},Y=()=>{const[s,e]=f(),{viewedModule:t,allocations:r}=s.context,n=t==="ram",{nodes:i,materials:l}=u("./static/computer.glb"),[{z:c}]=g({z:t==="ram"?b+.04:.04,config:v},[t]),p=()=>e({type:"VIEW_MODULE",module:n?null:"ram"});return o(h.mesh,{onClick:p,geometry:i.ram.geometry,material:l.red,"position-x":.07,"position-y":.01,"position-z":c,children:n&&o(x,{name:"ram",harvesters:r.harvester.ram,soldiers:r.soldier.ram,onClose:p})})},ee=()=>{const[s,e]=f(),{viewedModule:t,allocations:r}=s.context,n=t==="ssd",{nodes:i}=u("./static/computer.glb"),[{z:l}]=g({z:t==="ssd"?b+.02:.02,config:v},[t]),c=()=>e({type:"VIEW_MODULE",module:n?null:"ssd"});return o(h.mesh,{onClick:c,geometry:i.ssd.geometry,material:i.ssd.material,"position-x":0,"position-y":.06,"position-z":l,children:n&&o(x,{name:"ssd",harvesters:r.harvester.ssd,soldiers:r.soldier.ssd,onClose:c})})},te=e=>{var s=C(e,[]);const{nodes:t,materials:r}=u("./static/computer.glb");return a("group",T(L({},s),{dispose:null,children:[o("mesh",{geometry:t.motherboard.geometry,material:r.green}),o(Q,{}),o("mesh",{geometry:t.io.geometry,material:t.io.material,position:[-.09,.01,.03]}),o("mesh",{geometry:t["motherboard-gpu-io"].geometry,material:t["motherboard-gpu-io"].material,position:[-.04,-.08,-.01]}),o("mesh",{geometry:t["motherboard-cpu-io"].geometry,material:r.white}),o(Y,{}),o(X,{}),o(ee,{})]}))};u.preload("./static/computer.glb");const se=()=>a("div",{className:"h-screen w-screen",children:[a(V,{mode:"concurrent",dpr:Math.min(1.5,window.devicePixelRatio),gl:{antialias:!1},camera:{position:new P(0,0,.5)},children:[o("ambientLight",{}),o("pointLight",{position:[10,10,10]}),o(j,{enablePan:!1,enableZoom:!1,enableRotate:!0}),o(te,{}),a(B,{children:[o(W,{luminanceThreshold:0,luminanceSmoothing:.9,height:300}),o(G,{opacity:.1}),o(H,{eskil:!1,offset:.1,darkness:1.1})]})]}),o(J,{})]});F.render(o(K.StrictMode,{children:o(se,{})}),document.getElementById("root"));
